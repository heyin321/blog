(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{360:function(t,a,s){"use strict";s.r(a);var n=s(42),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"虚拟机的搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#虚拟机的搭建"}},[t._v("#")]),t._v(" 虚拟机的搭建")]),t._v(" "),s("p",[t._v("Oracle VirtualBox（网址是 https://www.virtualbox.org/） 是一款知名的开源虚拟机软件，本书后续的实验都将在 Oracle VirtualBox 创建的 Ubuntu Server 虚拟机上完成。虚拟机上安装部分软件的步骤也将逐一介绍，注意它们具有依赖性，因此需要按顺序安装。")]),t._v(" "),s("p",[t._v("VirtualBox 扩展功能的使用还可以参考“附录A - VirtualBox”。")]),t._v(" "),s("h3",{attrs:{id:"_2-1-安装-oracle-virtualbox"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-安装-oracle-virtualbox"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://cloudappdev.netlify.app/book/content.html#_2-1-%E5%AE%89%E8%A3%85-oracle-virtualbox",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),s("OutboundLink")],1),t._v("2.1 安装 Oracle VirtualBox")]),t._v(" "),s("p",[t._v("Oracle VirtualBox 在 Windows 操作系统上的安装过程很简单。因为开启虚拟机将占用较多内存，推荐 Windows 宿主机器是64位操作系统，且内存至少 8GB 以上。")]),t._v(" "),s("p",[t._v("安装步骤如下：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("假设 6.0 系列发行版的最新版本是“6.0.8” ，下载 “Windows hosts” 和 “Extension Pack”（如下图）。读者看到的版本应该已经更新，请视情况调整。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox6_Downloads.png",alt:"VirtualBox6_Downloads"}})]),t._v(" "),s("p",[t._v("图2.1.1 VirtualBox 6.0 下载网页")]),t._v(" "),s("p",[t._v("下载完成后可见： "),s("code",[t._v("VirtualBox-6.0.8-130520-Win.exe")]),t._v(" 和 "),s("code",[t._v("Oracle_VM_VirtualBox_Extension_Pack-6.0.8.vbox-extpack")]),t._v(" 共2个文件。 "),s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox6_Downloaded_Files.png",alt:"VirtualBox6_Downloaded_Files"}})]),t._v(" "),s("p",[t._v("图2.1.2 VirtualBox 6.0 的安装文件")])]),t._v(" "),s("li",[s("p",[t._v("安装 VirtualBox 必须要有管理员权限。以默认的设置和安装路径，先安装 "),s("code",[t._v("VirtualBox-6.0.8-130520-Win.exe")]),t._v("。安装过程中会导致暂时的网络中断，且需要重启 Windows 宿主机。")])]),t._v(" "),s("li",[s("p",[t._v("安装完成并重新启动宿主 Windows 计算机后，可以看到 "),s("code",[t._v("Oracle_VM_VirtualBox_Extension_Pack-6.0.8.vbox-extpack")]),t._v(" 的图标正常显示为绿色小盒子，双击即可安装此扩展包。如果碰到图标未能正常显示，也可以将它拖到 VirtualBox 在桌面的图标上来安装。")])])]),t._v(" "),s("p",[t._v("需要注意的是，Extension Pack 必须和 VirtualBox 安装相同版本，它包含了很多有用的功能增强，是必须安装的。")]),t._v(" "),s("p",[t._v("本书附录 A 还有 VirtualBox 的进阶使用介绍，供读者参考。")]),t._v(" "),s("h3",{attrs:{id:"_2-2-安装-ubuntu-server-虚拟机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-安装-ubuntu-server-虚拟机"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://cloudappdev.netlify.app/book/content.html#_2-2-%E5%AE%89%E8%A3%85-ubuntu-server-%E8%99%9A%E6%8B%9F%E6%9C%BA",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),s("OutboundLink")],1),t._v("2.2 安装 Ubuntu Server 虚拟机")]),t._v(" "),s("p",[t._v("Oracle VirtualBox 安装完成后，我们在 VirtualBox 里创建一个64位 Linux 类型的虚拟机，取名为 “ubuntuvm1”，给它分配 2GB 内存和 80GB 硬盘存储空间。注意这里分配的 80G 硬盘存储空间只是设定了虚拟硬盘的上限，而它实际占用的磁盘空间是根据写入内容的多少相关，因此不必担心一开始它就占用 80G 的磁盘存储空间。相反的，如果我们在创建虚拟机时把硬盘存储空间分配小了，到后面不够用，则扩容会很麻烦，甚至可能不得不重新安装虚拟机。")]),t._v(" "),s("p",[t._v("如下图所示创建虚拟机。输入虚拟机的名称（Name），这里是“ubuntuvm1”，注意选择正确的类型（Type）和版本（Version）。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox_ubuntuvm1_Settings_1.png",alt:"VirtualBox_ubuntuvm1_Settings_1"}})]),t._v(" "),s("p",[t._v("图2.2.1 VirtualBox Ubuntu 虚拟机设置之通用")]),t._v(" "),s("p",[t._v("到 Ubuntu Server 官方下载页面（网址是 https://www.ubuntu.com/download/server）下载安装光盘镜像文件。请选择下载标记为 LTS 的版本，它是长期支持（Long-Term Support）的版本。例如下面例子中下载的是 "),s("code",[t._v("ubuntu-18.04-live-server-amd64.iso")]),t._v("。另外请注意，此服务器版只有64位的发行版。")]),t._v(" "),s("p",[t._v("在虚拟机 ubuntuvm1 的设置对话框里，将下载的发行版 ISO 文件装载到光盘驱动器里。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox_ubuntuvm1_Settings_2.png",alt:"VirtualBox_ubuntuvm1_Settings_2"}})]),t._v(" "),s("p",[t._v("图2.2.2 VirtualBox Ubuntu 虚拟机设置之存储")]),t._v(" "),s("p",[t._v("启动虚拟机，即可开始 Ubuntu Server 的安装。大多以默认的选项安装，即以默认的美国英语安装，记得勾选“OpenSSH Server”（默认是不安装），具体过程可以参考 Installation Ubuntu Server（网址是 https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-server)，此处从略。")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("注意：")]),t._v(" 若您在国内访问国外网站速度过慢的情况下，可以考虑在安装过程中将官方 Ubuntu 的源替换成阿里云的 Ubuntu 镜像，这样会快些。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox6_use_mirrors_aliyun_ubuntu.png",alt:"img"}})])]),t._v(" "),s("p",[t._v("网络设置可以选择 “Bridged Adapter” ，即虚拟机的网卡桥接直连网络，这是最简单的方式。虚拟机启动完成后，登入虚拟机后用 "),s("code",[t._v("ip addr show")]),t._v("，也可以简写为"),s("code",[t._v("ip addr")]),t._v("， 或 "),s("code",[t._v("ifconfig")]),t._v(" 命令来找到它的 IP 地址。例如，下图中可见，此虚拟机 ubuntuvm1 的 IPv4 地址是 192.168.1.7。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox_ubuntuvm1_IP.png",alt:"VirtualBox_ubuntuvm1_IP"}})]),t._v(" "),s("p",[t._v("图2.2.3 VirtualBox Ubuntu 虚拟机的 IP 地址")]),t._v(" "),s("p",[t._v("在虚拟机已经启动后，如果桥接模式下我们发现桥接的网络不对，可以在虚拟机的设置里更改，如下图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox6_ubuntuvm1_Settings_bridged_network.png",alt:"VirtualBox6_ubuntuvm1_Settings_bridged_network"}})]),t._v(" "),s("p",[t._v("图2.2.4 VirtualBox Ubuntu 虚拟机的桥接网络设置")]),t._v(" "),s("p",[t._v("更改成正确的桥接网络后，按“OK”按钮保存。我们还需要在虚拟机的命令行窗口中运行如下命令，重新启动网络让它生效。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" netplan apply\n")])])]),s("p",[t._v("之后再去查看它新的 IP 地址。")]),t._v(" "),s("p",[t._v("为了方便使用，我们将通过专门的 SSH 客户端软件，例如 PuTTY（网址是 https://putty.org/）或 MobaXterm（网址是 "),s("a",{attrs:{href:"https://mobaxterm.mobatek.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://mobaxterm.mobatek.net"),s("OutboundLink")],1),t._v("）来连接到此虚拟机。其中前者功能相对简单快捷，后者功能丰富，其免费的 Home 版在功能上略有限制，但也足够个人一般使用。SSH 客户端的安装从略。")]),t._v(" "),s("p",[t._v("如果我们选择用开源免费的 PuTTY 作为 SSH 客户端，请按下图设置连接到此虚拟机（指定虚拟机的 IP 地址，SSH 服务默认侦听的22端口）。可以取名为“ubuntuvm1”并保存配置，方便下一次快速载入。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/SSH_Client_PuTTY_Configuration.png",alt:"SSH_Client_PuTTY_Configuration"}})]),t._v(" "),s("p",[t._v("图2.2.5 VirtualBox Ubuntu 虚拟机的 PuTTY 连接设置")]),t._v(" "),s("p",[t._v("登入后，检查防火墙状态。默认情况下，Ubuntu Server 虚拟机 ubuntuvm1 的防火墙是关闭的（Status: inactive）。本虚拟机是测试环境，暂不考虑安全性，为避免网络连接被防火墙阻隔的问题，可以暂不开启防火墙。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# check firewall status.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw status\n")])])]),s("p",[t._v("屏幕显示示例应该如下图。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox_ubuntuvm1_ufw_status.png",alt:"ubuntuvm1_ufw_status"}})]),t._v(" "),s("p",[t._v("图2.2.6 VirtualBox Ubuntu 虚拟机的防火墙状态")]),t._v(" "),s("p",[t._v("将系统更新到最新。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# update system to latest.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update -y\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" upgrade -y\n")])])]),s("blockquote",[s("p",[s("strong",[t._v("注意：")]),t._v(" apt 是继 apt-get 后的改进版命令行工具，它在2016年发布的 Ubuntu 16.04 中首次引入，日常使用上可以取代旧版的 apt-get 命令。也就是说，在 Ubuntu 16.04 和后续的 Ubuntu 操作系统中，apt-get 命令依然存在且可以使用，但在多数情况下，我们可以使用 apt 命令来取代旧版的 apt-get 命令。关于它们的区别，可以阅读这篇文章：")]),t._v(" "),s("ul",[s("li",[t._v("Difference Between apt and apt-get Explained https://itsfoss.com/apt-vs-apt-get-difference/")])])]),t._v(" "),s("p",[t._v("下面安装 “VirtualBox Guest Additions CD”。先在虚拟机的窗口如下图放入光盘。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/VirtualBox_Insert_Guest_Additions_CD.png",alt:"VirtualBox_Insert_Guest_Additions_CD"}})]),t._v(" "),s("p",[t._v("图2.2.7 VirtualBox Ubuntu 虚拟机放入 Guest Additions 光盘镜像")]),t._v(" "),s("p",[t._v("挂载光盘并安装。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mount the CD-ROM.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p /mnt/cdrom\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),t._v(" /dev/cdrom /mnt/cdrom\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# launch the installer.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /mnt/cdrom\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ./VBoxLinuxAddition.run\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# check the installed version.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" /opt "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" VBox\n")])])]),s("p",[t._v("安装完成后，在虚拟机设置里面将此光盘移除，可能需要重启虚拟机（reboot）。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# reboot the machine.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reboot")]),t._v("\n")])])]),s("p",[t._v("若实验完成后，需要关闭虚拟机，我们可以用如下任一命令：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# poweroff the machine.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" poweroff\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# shutdown the machine now.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),t._v(" -h now\n")])])]),s("h3",{attrs:{id:"_2-3-安装-openjdk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-安装-openjdk"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://cloudappdev.netlify.app/book/content.html#_2-3-%E5%AE%89%E8%A3%85-openjdk",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),s("OutboundLink")],1),t._v("2.3 安装 OpenJDK")]),t._v(" "),s("p",[t._v("以下内容是在 Ubuntu Server 虚拟机 ubuntuvm1 上安装免费开源的 OpenJDK （网址是 "),s("a",{attrs:{href:"https://openjdk.java.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://openjdk.java.net"),s("OutboundLink")],1),t._v("）。当然，也可以选择 Oracle JDK （网址是 http://www.oracle.com/technetwork/java/javase/downloads/index.html）。")]),t._v(" "),s("p",[t._v("关于安装 JDK (Java Development Kit，开发工具包) 的版本，我们这里建议安装 Java SE 8，其原因是：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Oracle Java SE 9 、10、12 是非长期支持版本，Java SE 8 因推出的时间久（2014年3月）而支持更为广泛，因此安装 JDK 8 是当前相对稳妥的选择。后续的长期支持版本（Long Term Support, LTS）是 JDK 11，在2018年9月26日发布，第三方软件在11上的支持还不够广泛。")])]),t._v(" "),s("li",[s("p",[t._v("Oracle Java SE 11 是继 Java 8之后首个长期支持版本，也是 Java SE 的首个长期支持版本。根据官方支持路线图，Java 11 的高级支持将持续到2023年9月，扩展支持则会延续到2026年9月，也就是生命周期长达8年。非长期支持的版本例如 Java 9、10、12 仅提供半年的技术支持。见下图：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/ubuntu_vm/oracle_jdk_support_roadmap.png",alt:"oracle_jdk_support_roadmap"}})]),t._v(" "),s("p",[t._v("图2.3.1 Oracle Java SE 技术支持路线图")])])]),t._v(" "),s("p",[t._v("Java SE 是否免费？这个问题有点复杂，接下来我们探究一下。")]),t._v(" "),s("p",[t._v("现在常见的 OpenJDK 和 Oracle JDK 以及其他服务商提供的变种版本，它们各自的授权许可是什么，又都提供哪些服务和支持，让许多 Java 开发者理不清头绪。Oracle 在2018年7月份启用新的 Java SE 订阅模式，更是让许多开发者认为是不是 Java 从此要开始收费了？")]),t._v(" "),s("p",[t._v("虽然 Java 11 LTS 已经发布，但从统计数据来看，至今（即本书写作时间，2019年）更多的开发者还停留在上一个 LTS 版本上，即 Java 8。关于开发者最为关注的 Java 8 的授权许可问题，官方文档给出了解答：")]),t._v(" "),s("blockquote",[s("p",[t._v("Oracle 将在2020年12月前为个人桌面用户继续提供 Oracle JDK 8 的公共更新。若是商业用途，则在2019年1月之后不会再有免费的商业版本更新。但是，自 Java SE 9 以后，Oracle 还提供了 OpenJDK 版本，可免费用于商业用途，并且还有其他服务商提供的免费 Open JDK 版本可供选择。")])]),t._v(" "),s("p",[t._v("也就是说，商业用途如果在2019年1月之后想继续免费使用 Java 8，可以选择：")]),t._v(" "),s("ul",[s("li",[t._v("不再更新，继续无限期地使用旧版 Oracle JDK 8 。注意，这对于商业用途是存在安全隐患的；")]),t._v(" "),s("li",[t._v("使用来自其他服务商的免费 Java SE 8 或 OpenJDK 8 二进制发行版。")])]),t._v(" "),s("p",[t._v("再有，由于 Oracle 在2018年7月份改变了 Java SE 的商业支持模式，所以从 Java 11 开始，支持方式有所不同：")]),t._v(" "),s("ul",[s("li",[t._v("OpenJDK —— 使用 GPLv2 + CE 许可，可免费用于商业用途；")]),t._v(" "),s("li",[t._v("Oracle JDK —— 使用付费商业许可，但个人和非商业使用免费。")])]),t._v(" "),s("p",[t._v("总之，商业用途如果想要继续免费使用 Java 11 的，请选择 OpenJDK。")]),t._v(" "),s("p",[t._v("Ubuntu 18.04 服务器操作系统如果更新到最新，已经自带了OpenJDK 11 的 JRE (Java Runtime Environment，Java 运行环境)，可以通过下面的命令进行检查：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ java -version\nopenjdk version "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"11.0.3"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),t._v("-04-16\nOpenJDK Runtime Environment "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.0")]),t._v(".3+7-Ubuntu-1ubuntu218.04.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOpenJDK "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("-Bit Server VM "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.0")]),t._v(".3+7-Ubuntu-1ubuntu218.04.1, mixed mode, sharing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nbobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" java\n/usr/bin/java\n\nbobyuan@ubuntuvm1:~$ readlink -f "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" java"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n/usr/lib/jvm/java-11-openjdk-amd64/bin/java\n")])])]),s("p",[t._v("进一步的信息还有。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" depends default-jdk\ndefault-jdk\n  Depends: default-jre "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(":1.11-68ubuntu1~18.04.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  Depends: default-jdk-headless "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(":1.11-68ubuntu1~18.04.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  Depends: openjdk-11-jdk\n\nbobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" list --installed "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" jdk\n\nWARNING: "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" does not have a stable CLI interface. Use with caution "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" scripts.\n\nopenjdk-11-jre-headless/bionic-updates,bionic-security,now "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11.0")]),t._v(".3+7-1ubuntu2~18.04.1 amd64 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("installed,automatic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("为了保证 Ubuntu 操作系统的稳定性，我们不卸载默认安装的 OpenJDK 11 JRE，只是并行安装额外的 OpenJDK 8，修改符号链接和环境变量指向我们想要使用的那个 OpenJDK 8 即可。")]),t._v(" "),s("p",[t._v("如前所述，出于免费商业使用的考虑，推荐安装使用 OpenJDK 而非 Oracle JDK。在当前（2019年）JDK 8 的使用和支持更广泛，鉴于 JDK 11 新推出，部分应用程序的兼容性支持还不足的原因，我们将按如下方式安装 OpenJDK 8：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# update system to latest.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" update -y\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" upgrade -y\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# install OpenJDK 8.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" openjdk-8-jdk\n")])])]),s("p",[t._v("安装完成之后，我们需要设置它为默认的 JDK。先用下面命令进行查看：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# list the installed JDKs.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" update-java-alternatives --list\n")])])]),s("p",[t._v("屏幕输出示例如下。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" update-java-alternatives --list\njava-1.11.0-openjdk-amd64      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1111")]),t._v("       /usr/lib/jvm/java-1.11.0-openjdk-amd64\njava-1.8.0-openjdk-amd64       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1081")]),t._v("       /usr/lib/jvm/java-1.8.0-openjdk-amd64\n")])])]),s("p",[t._v("我们可以看到，第2个选项 "),s("code",[t._v("java-1.8.0-openjdk-amd64")]),t._v(" 是我们想要设置为默认的选项。为了将 OpenJDK 8 设置为默认选项，可以用以下命令：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# set to use the specific JDK from the list.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" update-java-alternatives --set java-1.8.0-openjdk-amd64\n")])])]),s("p",[t._v("屏幕输出示例如下。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" update-java-alternatives --set java-1.8.0-openjdk-amd64\nupdate-alternatives: error: no alternatives "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" jaotc\nupdate-alternatives: error: no alternatives "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" jdeprscan\nupdate-alternatives: error: no alternatives "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" jhsdb\nupdate-alternatives: error: no alternatives "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" jimage\nupdate-alternatives: error: no alternatives "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" jlink\nupdate-alternatives: error: no alternatives "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" jmod\nupdate-alternatives: error: no alternatives "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" jshell\nupdate-alternatives: error: no alternatives "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" mozilla-javaplugin.so\nupdate-java-alternatives: plugin alternative does not exist: /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/IcedTeaPlugin.so\n")])])]),s("p",[t._v("更改完成后，检查一下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ readlink -f "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" java"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("\n/usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java\n\nbobyuan@ubuntuvm1:~$ java -version\nopenjdk version "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.8.0_212"')]),t._v("\nOpenJDK Runtime Environment "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.8")]),t._v(".0_212-8u212-b03-0ubuntu1.18.04.1-b03"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOpenJDK "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("-Bit Server VM "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25.212")]),t._v("-b03, mixed mode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("一切正常，符合预期。")]),t._v(" "),s("p",[t._v("根据上面的屏幕输出信息，我们可以看到 OpenJDK 8 的实际安装路径是 "),s("code",[t._v("/usr/lib/jvm/java-8-openjdk-amd64")]),t._v("，于是我们用 root 用户修改适用于虚拟机系统全局的配置文件 "),s("code",[t._v("/etc/profile")]),t._v("，在文件末尾添加如下几行内容：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# added by bobyuan.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JAVA_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/lib/jvm/java-8-openjdk-amd64\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JRE_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/lib/jvm/java-8-openjdk-amd64/jre\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/bin:"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v("\n")])])]),s("p",[t._v("这将使得上面两个环境变量（"),s("code",[t._v("JAVA_HOME")]),t._v(" 和 "),s("code",[t._v("JRE_HOME")]),t._v("）成为虚拟机 ubuntuvm1 的全局环境变量。")]),t._v(" "),s("p",[t._v("重启虚拟机，让设置生效。最后，分别用普通用户和 root 用户都检查一下，屏幕输出示例如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("\n/usr/lib/jvm/java-8-openjdk-amd64\n\nbobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JRE_HOME")]),t._v("\n/usr/lib/jvm/java-8-openjdk-amd64/jre\n\nbobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" java\n/usr/lib/jvm/java-8-openjdk-amd64/bin/java\n\nbobyuan@ubuntuvm1:~$ java -version\nopenjdk version "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.8.0_212"')]),t._v("\nOpenJDK Runtime Environment "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.8")]),t._v(".0_212-8u212-b03-0ubuntu1.18.04.1-b03"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOpenJDK "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("-Bit Server VM "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25.212")]),t._v("-b03, mixed mode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nbobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" -i\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("sudo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" password "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" bobyuan:\n\nroot@ubuntuvm1:~"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo $JAVA_HOME")]),t._v("\n/usr/lib/jvm/java-8-openjdk-amd64\n\nroot@ubuntuvm1:~"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# echo $JRE_HOME")]),t._v("\n/usr/lib/jvm/java-8-openjdk-amd64/jre\n\nroot@ubuntuvm1:~"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# which java")]),t._v("\n/usr/lib/jvm/java-8-openjdk-amd64/bin/java\n\nroot@ubuntuvm1:~"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# java -version")]),t._v("\nopenjdk version "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.8.0_212"')]),t._v("\nOpenJDK Runtime Environment "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.8")]),t._v(".0_212-8u212-b03-0ubuntu1.18.04.1-b03"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nOpenJDK "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),t._v("-Bit Server VM "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("build "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25.212")]),t._v("-b03, mixed mode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("输出符合预期，OpenJDK 8 安装完毕。")]),t._v(" "),s("h3",{attrs:{id:"_2-4-安装-apache-maven"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-安装-apache-maven"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://cloudappdev.netlify.app/book/content.html#_2-4-%E5%AE%89%E8%A3%85-apache-maven",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),s("OutboundLink")],1),t._v("2.4 安装 Apache Maven")]),t._v(" "),s("p",[t._v("Apache Maven（网址是 http://maven.apache.org/）是一个开源项目，它是一个 Java 的构建工具。在虚拟机 ubuntuvm1 上安装仅需要一条命令：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# install apache-maven package.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" maven\n")])])]),s("p",[t._v("安装完毕后，测试一下是否正常。例如：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" mvn\n/usr/bin/mvn\n\nbobyuan@ubuntuvm1:~$ mvn --version\nApache Maven "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.6")]),t._v(".0\nMaven home: /usr/share/maven\nJava version: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.8")]),t._v(".0_212, vendor: Oracle Corporation, runtime: /usr/lib/jvm/java-8-openjdk-amd64/jre\nDefault locale: en_US, platform encoding: UTF-8\nOS name: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"linux"')]),t._v(", version: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4.15.0-52-generic"')]),t._v(", arch: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"amd64"')]),t._v(", family: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unix"')]),t._v("\n")])])]),s("p",[t._v("至此，Apache Maven 已经安装完毕。根据上面的信息，我们可以看到 Maven 的实际安装路径是 "),s("code",[t._v("/usr/share/maven")]),t._v("。当前用户的 "),s("code",[t._v("~/.m2")]),t._v(" 文件夹存放着当前用户的设置，还有本地的 jar 包库（repository）。")]),t._v(" "),s("p",[t._v("以上是使用 "),s("code",[t._v("apt")]),t._v(" 命令从 Ubuntu 发行版的软件仓库里安装，推荐用这种方式安装，最为简单。")]),t._v(" "),s("p",[t._v("我们有可能会碰到这样一种情况，Maven 的最新版已经发布了一段时间，但还未加入到 Ubuntu 发行版的软件仓库里，导致用上面的方式安装的是旧版。在这种情况下，若希望安装 Maven 的最新版本，可以选择手动安装。")]),t._v(" "),s("p",[t._v("手动安装的步骤也非常简单，请参考下面的步骤。或者参考官方的安装文档（网址是 http://maven.apache.org/install.html）。")]),t._v(" "),s("p",[t._v("假设我们在 Maven 的官方网站看到最新版是 3.6.1，想选择手动安装这个最新版。我们到官方网站下载最新版的安装包 "),s("code",[t._v("apache-maven-3.6.1-bin.tar.gz")]),t._v(" 到当前用户的 Home 文件夹中，想将它安装在 "),s("code",[t._v("/usr/local")]),t._v(" 文件夹里。按以下步骤解包并创建符号链接。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# move to the target directory.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /usr/local\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# extract the release package.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" zxf ~/apache-maven-3.6.1-bin.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# create symbolic link to the real installation.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ln")]),t._v(" -s apache-maven-3.6.1 apache-maven\n")])])]),s("p",[t._v("完成后，用 "),s("code",[t._v("ls -la")]),t._v(" 命令查看文件清单，我们可以看到类似这样的输出。它显示 "),s("code",[t._v("apache-maven")]),t._v(" 符号链接指向真正的安装路径 "),s("code",[t._v("apache-maven-3.6.1")]),t._v("。后面我们将使用此符号链接来设置环境变量。之所以使用符号链接，其目的是，若后期我们升级 Maven 到其他的安装版，将仅需要修改此符号链接指向新的安装版路径即可。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/maven/usr_local_apache_maven.png",alt:"usr_local_apache_maven"}})]),t._v(" "),s("p",[t._v("图2.4.1 列文件清单查看Maven的安装")]),t._v(" "),s("p",[t._v("用 root 用户修改 "),s("code",[t._v("/etc/profile")]),t._v(" 文件。如下例所示，添加了 "),s("code",[t._v("M2_HOME")]),t._v(" 环境变量，并修改了环境变量 "),s("code",[t._v("PATH")]),t._v("，将 "),s("code",[t._v("M2_HOME/bin")]),t._v(" 添加到 "),s("code",[t._v("PATH")]),t._v(" 路径中。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# added by bobyuan.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JAVA_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/lib/jvm/java-8-openjdk-amd64\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("JRE_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/lib/jvm/java-8-openjdk-amd64/jre\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("M2_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/apache-maven\n\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$JAVA_HOME")]),t._v("/bin:"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$M2_HOME")]),t._v("/bin:"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$PATH")]),t._v("\n")])])]),s("p",[t._v("至此手动安装已经完毕。我们退出当前用户，重新登入后，检查一下。")]),t._v(" "),s("p",[t._v("屏幕输出示例如下。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("which")]),t._v(" mvn\n/usr/local/apache-maven/bin/mvn\n\nbobyuan@ubuntuvm1:~$ mvn --version\nApache Maven "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.6")]),t._v(".1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("d66c9c0b3152b2e69ee9bac180bb8fcc8e6af555"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2019")]),t._v("-04-04T19:00:29Z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nMaven home: /usr/local/apache-maven\nJava version: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.8")]),t._v(".0_212, vendor: Oracle Corporation, runtime: /usr/lib/jvm/java-8-openjdk-amd64/jre\nDefault locale: en_US, platform encoding: UTF-8\nOS name: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"linux"')]),t._v(", version: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4.15.0-52-generic"')]),t._v(", arch: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"amd64"')]),t._v(", family: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unix"')]),t._v("\n")])])]),s("p",[t._v("可以看到，它显示的路径和版本，都符合我们的预期。")]),t._v(" "),s("p",[t._v("Maven 的基本使用请参考官方用户手册文档（网址是 http://maven.apache.org/users/index.html)。 另外，还有多本 Maven 的相关书籍，例如《Maven 实战》，《Maven 应用实战》等。")]),t._v(" "),s("h3",{attrs:{id:"_2-5-安装-jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-安装-jenkins"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://cloudappdev.netlify.app/book/content.html#_2-5-%E5%AE%89%E8%A3%85-jenkins",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),s("OutboundLink")],1),t._v("2.5 安装 Jenkins")]),t._v(" "),s("p",[t._v("Jenkins（网址是 https://jenkins.io/) 是一个开源项目，它是一个基于 Java 的持续集成系统。我们可以在 Jenkins 上配置持续集成的任务，让机器自动完成构建（build），集中展示集成中存在的错误，提供详细的日志文件，提醒功能，以及用图表的形式展示项目构建的趋势和稳定性。")]),t._v(" "),s("p",[t._v("在 Ubuntu 上安装 Jenkins，请参考官方安装文档：")]),t._v(" "),s("p",[t._v("https://jenkins.io/doc/book/installing/#debian-ubuntu")]),t._v(" "),s("p",[t._v("下面的步骤选择用 "),s("code",[t._v("apt-get")]),t._v(" 方式来安装，具体命令如下。如果网络访问较慢，请耐心等待。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" -q -O - https://pkg.jenkins.io/debian/jenkins.io.key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" apt-key "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" -\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" -c "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" jenkins\n")])])]),s("p",[t._v("安装完成后，它会自动启动 Jenkins 服务。我们看一下它的状态，从屏幕输出可以看到，它当前正常运行。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl status jenkins\n● jenkins.service - LSB: Start Jenkins at boot "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("time")]),t._v("\n   Loaded: loaded "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("/etc/init.d/jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" generated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   Active: active "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exited"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" since Wed "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2018")]),t._v("-07-11 09:09:56 UTC"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 50s ago\n     Docs: man:systemd-sysv-generator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    Tasks: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("limit: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2322")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   CGroup: /system.slice/jenkins.service\n\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:55 ubuntuvm1 systemd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": Starting LSB: Start Jenkins at boot time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:55 ubuntuvm1 jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5787")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": Correct java version found\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:55 ubuntuvm1 jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5787")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":  * Starting Jenkins Automation Server jenkins\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:55 ubuntuvm1 su"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5833")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": Successful "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("su")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" jenkins by root\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:55 ubuntuvm1 su"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5833")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": + ??? root:jenkins\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:55 ubuntuvm1 su"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5833")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": pam_unix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("su:session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": session opened "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" user jenkins by "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uid"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:55 ubuntuvm1 su"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5833")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": pam_unix"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("su:session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": session closed "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" user jenkins\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:56 ubuntuvm1 jenkins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5787")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".done.\nJul "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" 09:09:56 ubuntuvm1 systemd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": Started LSB: Start Jenkins at boot time.\n")])])]),s("p",[t._v("Jenkins 默认的侦听端口是8080，通过浏览器输入 ubuntuvm1 虚拟服务器地址和8080端口即可访问。首次访问需要解锁，请按屏幕提示操作。例如，从虚拟机里面查到密码是 “2bcb508f031743d5ada3fefb93e3167d”，将它填写在 “Administrator password” 输入框里，再按 “Continue” 按钮提交。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/jenkins/Ashampoo_Snap_2018.07.11_17h20m34s_001_Jenkins_1.png",alt:"Jenkins admin"}})]),t._v(" "),s("p",[t._v("图2.5.1 Jenkins 安装后解锁")]),t._v(" "),s("p",[t._v("选择让 Jenkins 加载常用的插件。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/jenkins/Ashampoo_Snap_2018.07.11_17h30m31s_002_SetupWizard_1.png",alt:"Jenkins SetupWizard 1"}})]),t._v(" "),s("p",[t._v("图2.5.2 Jenkins 加载常用插件")]),t._v(" "),s("p",[t._v("插件加载完成后，将可以设置管理员账号，请牢记用户名和密码。然后设置服务器的URL，这步对于目前安装在虚拟机上供实验实验的 Jenkins 实例不太重要，可以暂时跳过（在 Jenkins 设置页面中还有机会更改）。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/jenkins/Ashampoo_Snap_2018.07.11_17h33m14s_003_SetupWizard_2.png",alt:"Jenkins SetupWizard 2"}})]),t._v(" "),s("p",[t._v("图2.5.3 Jenkins 创建首个管理员用户")]),t._v(" "),s("p",[t._v("至此安装配置完毕，进入 Jenkins 的欢迎页面。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/jenkins/Ashampoo_Snap_2018.07.11_17h36m37s_004_Dashboard_1.png",alt:"Jenkins Dashboard 1"}})]),t._v(" "),s("p",[t._v("图2.5.4 Jenkins 欢迎页面")]),t._v(" "),s("p",[t._v("Jenkins 正确安装后：")]),t._v(" "),s("ul",[s("li",[t._v("Jenkins 的配置文件是： "),s("code",[t._v("/etc/default/jenkins")])]),t._v(" "),s("li",[t._v("Jenkins 的后台服务进程是： "),s("code",[t._v("/etc/init.d/jenkins")])]),t._v(" "),s("li",[t._v("Jenkins 的后台日志是： "),s("code",[t._v("/var/log/jenkins/jenkins.log")])]),t._v(" "),s("li",[t._v("创建了 jenkins:jenkins 用户以启动 Jenkins 服务。")])]),t._v(" "),s("p",[t._v("为了避免端口占用冲突，我们将 Jenkins 的侦听端口从默认的8080改为9090。修改配置文件 "),s("code",[t._v("/etc/default/jenkins")]),t._v("，再重启 Jenkins 服务，具体如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# stop Jenkins service.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl stop jenkins\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# change from "HTTP_PORT=8080" to "HTTP_PORT=9090" in this file.')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /etc/default/jenkins\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# restart Jenkins service.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start jenkins\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# check service status, should be active now.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl status jenkins\n")])])]),s("p",[t._v("至此，Jenkins 已经修改到侦听于9090端口了。 接上例，若虚拟机 ubuntuvm1 的 IP 地址是192.168.1.7，我们可以通过 http://192.168.1.7:9090/ 来访问虚拟机 ubuntuvm1 上的 Jenkins 应用程序了。")]),t._v(" "),s("p",[t._v("注意本例中 Jenkins 是以服务的方式安装的，即虚拟机重启后，Jenkins 会自动以服务的方式启动。")]),t._v(" "),s("p",[t._v("Jenkins 的基本使用请参考官方文档（网址是 https://jenkins.io/doc/)。 另外，还有多本 Jenkins 的相关书籍，例如《Jenkins 权威指南》，《Mastering Jenkins》等。")]),t._v(" "),s("h3",{attrs:{id:"_2-6-安装-apache-tomcat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-安装-apache-tomcat"}},[t._v("#")]),t._v(" "),s("a",{attrs:{href:"https://cloudappdev.netlify.app/book/content.html#_2-6-%E5%AE%89%E8%A3%85-apache-tomcat",target:"_blank",rel:"noopener noreferrer"}},[t._v("#"),s("OutboundLink")],1),t._v("2.6 安装 Apache Tomcat")]),t._v(" "),s("p",[t._v("Apache Tomcat（网址是 http://tomcat.apache.org/）是知名的 Java Web 应用程序服务器。本文中的 Web 应用程序将部署到 Tomcat 上运行，作为开发和测试环境，因而选择更灵活的手动安装模式。")]),t._v(" "),s("p",[t._v("Apache Tomcat 有多个发行版。在本文写作的时间，可以看见同时有 7、8、9 三个版本，本文将选择最新的 9 版本（下载链接 https://tomcat.apache.org/download-90.cgi），版本号是 9.0.21。")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("注意：")]),t._v(" 在您阅读本书的时候，最新的 Tomcat 版本很可能已经不是这个版本了，因此下载链接可能失效，应根据当时的版本号对应的下载链接，适当修改命令。")])]),t._v(" "),s("p",[t._v("我们还可以参考以下的官方安装文档：")]),t._v(" "),s("ul",[s("li",[t._v("Apache Tomcat 官方的安装文档 http://tomcat.apache.org/tomcat-9.0-doc/setup.html")]),t._v(" "),s("li",[t._v("Ubuntu 官方的安装文档 https://help.ubuntu.com/lts/serverguide/tomcat.html")])]),t._v(" "),s("p",[t._v("本机安装的 Tomcat 实例主要用于部署 Web 应用程序，作为测试环境。用当前用户 “bobyuan” 来安装和启动 Tomcat， 它的安装路径选择在 "),s("code",[t._v("/usr/local")]),t._v("。先把安装包下载到当前用户的 Home 路径中，按如下命令执行安装过程，将创建符号链接 "),s("code",[t._v("/usr/local/apache-tomcat")]),t._v(" 指向真实的安装路径 ，例如这里是"),s("code",[t._v("/usr/local/apache-tomcat-9.0.21")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# we will going to install tomcat here.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /usr/local\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# unpack the tomcat release package.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" xzf ~/apache-tomcat-9.0.21.tar.gz\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# change ownership to current user bobyuan")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("chown")]),t._v(" -R bobyuan:bobyuan ./apache-tomcat-9.0.21\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# create symbolic link pointing to the specific tomcat release.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ln")]),t._v(" -s apache-tomcat-9.0.21 apache-tomcat\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# remove the tomcat release package.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" ~/apache-tomcat-9.0.21.tar.gz\n")])])]),s("p",[t._v("列文件清单，查看 Tomcat 的安装，应该如下图所示。须注意符号连接“apache-tomcat”指向真正的安装路径。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/tomcat/usr_local_apache_tomcat.png",alt:"usr_local_apache_tomcat"}})]),t._v(" "),s("p",[t._v("图2.6.1 列文件清单查看Tomcat的安装")]),t._v(" "),s("p",[t._v("修改当前用户 “bobyuan” 的 "),s("code",[t._v("~/.profile")]),t._v("，在最后添加一行如下内容：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CATALINA_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/local/apache-tomcat\n")])])]),s("p",[t._v("退出当前用户并重新登录（这将载入更新后的 "),s("code",[t._v("~/.profile")]),t._v("）。")]),t._v(" "),s("p",[t._v("用当前用户 “bobyuan” 启动和关闭 Tomcat 服务，命令如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# start Tomcat server.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CATALINA_HOME")]),t._v("/bin/startup.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# stop Tomcat server.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$CATALINA_HOME")]),t._v("/bin/shutdown.sh\n")])])]),s("p",[t._v("Tomcat 默认的侦听端口是 8080，启动后，我们可以看到8080端口正在侦听。命令如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("bobyuan@ubuntuvm1:~$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("netstat")]),t._v(" -an "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\ntcp6       "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" :::8080                 :::*                    LISTEN\n")])])]),s("p",[t._v("因此，若虚拟机的 IP 地址是 192.168.42.61，则可以用 http://192.168.42.61:8080 来访问 Tomcat，如果看到了 Tomcat 的欢迎页面（如下图），则表示安装和运行是正确的。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/tomcat/tomcat_9_welcome_page.png",alt:"Tomcat welcome page"}})]),t._v(" "),s("p",[t._v("图2.6.2 Tomcat的欢迎页面")]),t._v(" "),s("p",[t._v("注意，以上 Tomcat 并非以系统服务的方式安装，因此，启动和关闭 Tomcat 都需要手动操作，执行启动和关闭命令。另外，虚拟机重启后也需要手动启动 Tomcat 服务。")]),t._v(" "),s("p",[t._v("至此，Tomcat 的安装已经完成。")]),t._v(" "),s("p",[t._v("以下是可选的步骤，“manager” 和 “host-manager” 是Tomcat自带的 Web 界面管理应用程序，在后续的实验中并未用到，我们也可以选择跳过。")]),t._v(" "),s("p",[t._v("为了使用 Tomcat 的 “manager” 和 “host-manager” 两个 Web 应用程序，需要继续按如下步骤设置。")]),t._v(" "),s("p",[t._v("修改 Tomcat 的管理员登录账号。编辑配置文件 "),s("code",[t._v("conf/tomcat-users.xml")]),t._v(" ，添加如下内容。注，下例中用 "),s("code",[t._v("itsasecret")]),t._v(" 作为密码，它可以更改成其它的密码。")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- user manager can access only manager section --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("role")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rolename")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("manager-gui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("user")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("manager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("password")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("itsasecret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("roles")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("manager-gui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- user admin can access manager and admin section both --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("role")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rolename")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("admin-gui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("user")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("username")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("admin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("password")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("itsasecret"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("roles")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("manager-gui,admin-gui"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),s("p",[t._v("如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/tomcat/Ashampoo_Snap_2018.07.12_13h08m47s_004_tomcat_2.png",alt:"Tomcat config 1"}})]),t._v(" "),s("p",[t._v("图2.6.3 Tomcat 的用户设置")]),t._v(" "),s("p",[t._v("默认的情况下，出于安全考虑，Tomcat 的 “manager” 和 “host-manager” web 应用程序只能从本地（localhost）访问。如果要从其它机器远程访问，则需要修改配置文件，将远端机器的 IP 或 IP 地址段添加到配置文件中。配置文件如下：")]),t._v(" "),s("ul",[s("li",[t._v("Manager File: "),s("code",[t._v("./webapps/manager/META-INF/context.xml")])]),t._v(" "),s("li",[t._v("Host Manager File: "),s("code",[t._v("./webapps/host-manager/META-INF/context.xml")])])]),t._v(" "),s("p",[t._v("如下图所示，我们需要从 Windows Host 主机来访问虚拟机上的 “manager” 和 “host-manager” web 应用程序，经查 Windows Host 主机的 IP 地址是 192.168.1.10，则在配置文件里添加 “192.168.1.10” 为远程访问客户端：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cloudappdev.netlify.app/book/img/tomcat/tomcat-enable-remote-access.png",alt:"Tomcat remote access"}})]),t._v(" "),s("p",[t._v("图2.6.4 Tomcat 的远程管理访问设置")]),t._v(" "),s("p",[t._v("若虚拟机的 IP 地址是 192.168.42.61，我们于是可以在 Windows Host 主机上，通过浏览器用 http://192.168.42.61:8080/manager/ （用户名 / 密码： manager / itsasecret）来访问 “Tomcat Web Application Manager”，用 http://192.168.42.61:8080/host-manager/ （用户名 / 密码： admin / itsasecret）来访问 “Tomcat Virtual Host Manager”。")])])}),[],!1,null,null,null);a.default=e.exports}}]);